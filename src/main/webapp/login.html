<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="">
<meta name="author" content="">

<title>SB Admin 2 - Bootstrap Admin Theme</title>

<!-- Bootstrap Core CSS -->
<link href="styles/bootstrap.css" rel="stylesheet">

<!-- jQuery -->
<script src="scripts/jquery-1.7.2.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="scripts/bootstrap.js"></script>

<script type="text/javascript" src="scripts/jquery.pageController.js"></script>
<script type="text/javascript" src="scripts/jquery.alerts.js"></script>

<script type="text/javascript">
	/*声明一个页面管理对象*/
	var controller = null;

	/*当页面加载时执行的动作*/
	$(document).ready(function() {
		/*实例化页面管理类*/
		controller = new $.Controller();
		controller.init();
		/*页面加载时进行查询操作*/

	});

	/*定义一个页面管理类*/
	(function($) {
		$.Controller = function() {
			this.settings = $.extend(true, {}, $.Controller.defaults);//构造方法：将管理页面的变量赋给this.settings
		};
		$.extend($.Controller, {
			defaults : {// 声明全局变量
				loginBtn : "#login",
				username : "#username",
				password : "#password",
				msg:"#msg"
			},
			prototype : {// 声明全局方法
				init : function() {
					var _this = this;
					_this.bindEvents();
				},
				bindEvents : function() {
					var _this = this;
					$(_this.settings.loginBtn).bind("click", function() {
						_this.toLogin();
					});
				},
				getRootPath : function() {
					//获取当前网址，如： http://localhost:8083/uimcardprj/share/meun.jsp
					var curWwwPath = window.document.location.href;
					//获取主机地址之后的目录，如： uimcardprj/share/meun.jsp
					var pathName = window.document.location.pathname;
					var pos = curWwwPath.indexOf(pathName);
					//获取主机地址，如： http://localhost:8083
					var localhostPaht = curWwwPath.substring(0, pos);
					//获取带"/"的项目名，如：/uimcardprj
					var projectName = pathName.substring(0, pathName.substr(1)
							.indexOf('/') + 1);
					return (localhostPaht + projectName);
				},
				toLogin : function() {
					var _this = this;
					var name = $('#username').val();
					var pwd = $('#password').val();

					pageManager.CPUAjax({
						type : "POST",
						url : _this.getRootPath() + "/login",
						dataType : "json",
						data : {
							username : name,
							password : pwd
						},
						success : function(data) {
							if (data.res_result == "success") {
								window.location.href = _this.getRootPath();
							} else {
								//$('#msg').html(data.res_msg);
								jAlert(data.res_msg);
							}
						},
						error : function(data) {
							//$('#msg').html(data);
							window.location.reload();
						}
					});
				}
			}
		});
	})(jQuery);
</script>

</head>

<body>

	<div class="container">
		<div class="row">
			<div class="col-md-4 col-md-offset-4">
				<div class="login-panel panel panel-default">
					<div class="panel-heading">
						<h3 class="panel-title">Please Sign In</h3>
					</div>
					<div class="panel-body">
						<form role="form">
							<fieldset>
								<div class="form-group">
									<input class="form-control" placeholder="Username"
										id="username" type="email" autofocus>
								</div>
								<div class="form-group">
									<input class="form-control" placeholder="Password"
										id="password" type="password" value="">
								</div>
								<div class="checkbox">
									<label> <input name="remember" type="checkbox"
										value="Remember Me">Remember Me
									</label>
								</div>
								<div class="label" id="msg"></div>
								<!-- Change this to a button or input when using this as a form -->
								<a class="btn btn-lg btn-success btn-block" id="login">Login</a>
							</fieldset>
						</form>
					</div>
				</div>
			</div>
		</div>
	</div>

</body>

</html>
